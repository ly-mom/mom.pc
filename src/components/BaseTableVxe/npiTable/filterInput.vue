<template>
  <span style="display: inline-block">
    <span style="margin-right: 5px">{{ name }}</span>
    <el-popover placement="bottom" width="180" trigger="hover" v-model="visible">
      <el-input v-if="visible" v-model="search" size="mini" placeholder="输入关键字搜索" @keyup.enter.native="enterHandler" clearable @clear="enterHandler" @blur="visible = false" />
      <span slot="reference">
        <template v-if="remote">
          <svg t="1672724780477" v-if="isFilter" class="icon" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4388" width="12" height="12">
            <path
              d="M707.101 84a57.559 57.559 0 0 1 35 11.862c25.211 19.31 29.98 55.384 10.65 80.57l-240.649 313.56v367.325a43.64 43.64 0 0 1-4.632 19.566l-0.52 1.006c-11.374 21.277-37.858 29.316-59.157 17.954L340.92 838.83c-26.222-13.989-42.598-41.272-42.598-70.97V491.217L55.933 176.51a57.432 57.432 0 0 1-11.922-33.893L44 141.467C44 109.729 69.754 84 101.522 84z m192.987 694.197c16.52 0 29.912 13.38 29.912 29.883 0 16.268-13.012 29.5-29.206 29.874l-0.706 0.008H614.771c-16.52 0-29.911-13.378-29.911-29.882 0-16.268 13.012-29.5 29.205-29.875l0.706-0.008h285.317z m0-160.906c16.52 0 29.912 13.378 29.912 29.882 0 16.268-13.012 29.5-29.206 29.875l-0.706 0.008H614.771c-16.52 0-29.911-13.38-29.911-29.883 0-16.268 13.012-29.5 29.205-29.874l0.706-0.008h285.317z m0-160.907c16.52 0 29.912 13.379 29.912 29.883 0 16.268-13.012 29.5-29.206 29.874l-0.706 0.008H614.771c-16.52 0-29.911-13.379-29.911-29.882 0-16.268 13.012-29.5 29.205-29.875l0.706-0.008h285.317z"
              fill="#409eff"
              p-id="4389"
            ></path>
          </svg>
          <svg t="1672724857812" v-else class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4705" width="12" height="12">
            <path
              d="M921.6 686.08h-245.76c-10.24 0-20.48-10.24-20.48-20.48s10.24-20.48 20.48-20.48H921.6c10.24 0 20.48 10.24 20.48 20.48s-10.24 20.48-20.48 20.48z m0-122.88h-245.76c-10.24 0-20.48-10.24-20.48-20.48s10.24-20.48 20.48-20.48H921.6c10.24 0 20.48 10.24 20.48 20.48s-10.24 20.48-20.48 20.48z m-166.4-289.28c-2.56 2.56-243.2 227.84-243.2 227.84v389.12l-163.84-81.92v-307.2L112.64 281.6c-2.56-2.56-5.12-5.12-7.68-5.12-15.36-15.36-23.04-35.84-23.04-58.88 0-46.08 38.4-84.48 84.48-84.48h527.36c46.08 0 84.48 38.4 84.48 84.48 0 23.04-10.24 43.52-23.04 56.32zM693.76 179.2H166.4C145.92 179.2 128 197.12 128 217.6c0 10.24 2.56 20.48 10.24 25.6l2.56 2.56 227.84 215.04 15.36 12.8 2.56 25.6-2.56 273.92 81.92 40.96V473.6l15.36-12.8 230.4-212.48 2.56-2.56c7.68-7.68 10.24-15.36 10.24-25.6 7.68-23.04-10.24-40.96-30.72-40.96z m-17.92 588.8H921.6c10.24 0 20.48 10.24 20.48 20.48s-10.24 20.48-20.48 20.48h-245.76c-10.24 0-20.48-10.24-20.48-20.48 0-12.8 7.68-20.48 20.48-20.48z"
              fill="#606266"
              p-id="4706"
            ></path>
          </svg>
        </template>
        <template v-else>
          <svg v-if="isFilter" t="1656297761842" class="icon" style="padding-top: 2px" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4161" width="12" height="12">
            <path
              d="M800.46125676 126.00961539H223.53874324c-30.64932016 0-54.08653846 23.4372183-54.08653846 54.08653846v32.45192309c0 14.42335863 5.40865385 27.04326923 14.42251352 36.057974l237.98076923 219.95135967c10.81730769 10.81730769 18.02940955 25.24066631 18.02940956 39.66402494v268.62924429c0 18.02940955 9.01385967 36.05797401 25.23982121 45.07267879l91.94711537 55.88914137c1.80344802 5.40865385 5.40865385 5.40865385 9.01470479 5.40865385 9.01470478 0 18.02856445-7.21125676 18.02856445-18.02856445v-356.97115385c0-14.42335863 7.21210187-28.84671725 18.02940957-39.66402494l237.98076922-219.95135967c9.01385967-10.81730769 14.42251353-23.4380634 14.42251352-36.05797402V180.09615385c0-30.64932016-23.4372183-54.08653846-54.08653846-54.08653846z"
              p-id="4162"
              fill="#409eff"
            ></path>
          </svg>
          <svg v-else t="1656296992791" style="padding-top: 2px" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3887" width="12" height="12">
            <path
              d="M878.27692308 134.78290599c-3.93846154-7.87692308-11.81538462-11.81538462-19.6923077-11.81538462H161.47692308c-7.87692308 0-15.75384615 3.93846154-19.6923077 11.81538462s0 15.75384615 3.93846154 19.69230769L409.6 422.2905983c3.93846154 3.93846154 3.93846154 7.87692308 3.93846154 11.81538461v326.8923077c0 7.87692308 3.93846154 11.81538462 7.87692308 15.75384615l63.01538461 47.26153846c7.87692308 7.87692308 19.69230769 3.93846154 27.56923077-3.93846154s3.93846154-19.69230769-3.93846154-27.56923077l-55.13846154-39.38461538V434.10598291c0-15.75384615-3.93846154-27.56923077-15.75384615-39.38461538L208.73846154 162.35213676h602.58461538L586.83076923 394.72136753c-11.81538462 11.81538462-15.75384615 23.63076923-15.75384615 39.38461538v437.16923077c0 11.81538462 7.87692308 19.69230769 19.69230769 19.69230769s19.69230769-7.87692308 19.69230769-19.69230769V434.10598291c0-3.93846154 0-7.87692308 3.93846154-11.81538461l259.93846154-267.81538462c7.87692308-3.93846154 7.87692308-11.81538462 3.93846154-19.69230769z"
              p-id="3888"
              fill="#606266"
            ></path>
          </svg>
        </template>
      </span>
    </el-popover>
  </span>
</template>

<script>
export default {
  name: 'FilterInput',
  data() {
    return {
      search: '',
      isFilter: false,
      visible: false,
    }
  },
  props: {
    name: {
      type: String,
      default: '',
    },
    attributeName: {
      type: String,
      default: '',
    },
    // 是否远程筛选
    remote: {
      type: Boolean,
      default: false,
    },
  },
  methods: {
    enterHandler() {
      const item = {
        attributeVal: this.search,
        attributeName: this.attributeName,
        remote: this.remote,
        type: 'include',
      }
      this.visible = false
      this.$emit('search-change', item)
      this.isFilter = !!this.search
    },
  },
}
</script>
